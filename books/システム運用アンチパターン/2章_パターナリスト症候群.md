# 2.0 はじめに
## まとめ
- 不要なゲートキーピングがないかプロセスを検証する
- なぜ承認が必要なのかを理解する
- 承認プロセスが解決しようとしている懸念事項を自動化で解決する
- 自動処理におけるログ・通知・エラー処理に関する懸念事項をうまく解決できるような設計にする
- 自動化の継続的な改善に取り組む

## 内容
- プロセスにおける障壁を安全装置に置き換える方法
- ゲートキーパーという概念の理解
- 自動化によるゲートキーパーの排除
- 承認プロセスを自動化する際に生じる問題の解決方法

## 由来
あるグループが他のグループに対して親のような関係を築いていることから名付けられた

## パターナリスト
親子関係のように、強い立場にある者が弱い立場の者に対して介入することを指す

## 特徴
パターナリスト症候群では仕事の進め方やタイミングを**ゲートキーパー**と呼ばれる、権力を持つ人に委ねる
→権力の集中は、最初は賢明な判断のように見えるがすぐに生産性の低下を招く

# 2.1 安全装置ではなく障壁を作ってしまう

- 特定の人に権限を与えることでリスクを減らすのは間違い
- 属人化を招いており特定の人にプレッシャーが集中する
- 他のエンジニアができない時点でシステムの安全性が欠けている

**責任範囲を明確にすることは必ずしも良いことではない!!**
→チームの摩擦につながる


承認プロセスを設けても、問題が起こるたびに承認事項や承認者が追加され、重くて負担の大きいプロセスが出来上がる

## DevOps組織でのあり方
価値を付加するものは残しつつ人為的な障壁を取り除くことに常に気を配る

## なぜDevOpsなのか？
1. 文化的な問題に正面から取り組んでいる→問題は技術よりも人にあることが多い
2. 人間の能力の浪費によるコストに焦点を当てている→自動化

## DevOpsのゴール
- チーム間のコラボレーションの強化
- 不必要なゲートや作業の受け渡しの削減
- 開発チームがシステムを所有するために必要なツールと権限の提供
- 再現性のある予測可能なプロセスの構築
- アプリケーションの本番環境に対する責任の共有

## CMAS
メトリクス：測定基準

**パターナリスト症候群は、信頼の欠如によってゲートキーパーが導入されるときに起こる**

# 2.2 ゲートキーパーの導入
ゲートキーパーの導入はパターナリスト症候群につながる
何か問題が起こったときにはボトルネックを追加するのではなく、自動化を行うべき

**DevOps組織では効率的で迅速なデリバリに重点を置く**

# 2.3 ゲートキーバーの分析
手動で行なっている承認フローをいかにして自動化するか？
手動で行う場合、単一の問題はクリアできるが必ずイレギュラーケースがある
また、チーム間のコミュニケーションコストが増えるなどデメリットも多い

# 2.4 自動化によるパターナリスト症候群の解消
ゲートキーパーはステークホルダーに近い立場、自動化を検討する際には必ず参加してもらう

プロセス自動化の初期フェーズで取り上げるトピック
- 承認プロセスに費やす時間の削減
- 管理タスクに費やす時間の削減
- 反復時間の短縮
- プロセスフローの一貫性の確立

# 2.5 承認の目的を把握する

# 2.6 自動化のためのコードの構成
プロセス自動化の段階分け
1. 承認プロセス：許可するために必要なチェック項目は何か？
2. ロギングプロセス：依頼・承認・実行・結果をどこに記録するか？
3. 通知プロセス：処理が実行されたことを自動ツールがどこで人々に通知するか？
4. エラー処理：どの程度まで自動復旧を行うか？

## 2.6.1 承認プロセス
承認者がプロセスの中で何を確認しているかを明らかにする→レビューも同じ？

スペルチェックや文法間違い→ツールを使う
ビジネスロジックに沿っているか→手動で行う
**自動化すべきかどうか区別して行う必要あり**

## 2.6.2 承認の自動化
自動化の設計、まずは2つの領域に分ける
1. 実際の承認を処理する領域
2. 承認が得られた場合に実行する必要のあるコマンドを処理する領域

**ベースクラス**を定義する
それを継承したすべての承認クラスは同じ構造に従うようになる

```java
class BaseApproval:
    def is_approved(self):
        raise NotImplementedError()
    def error_message(self):
        raise NotImplementedError()
```

## 2.6.3 ロギングプロセス
ログはシステムからユーザーに送るのではなく、ユーザーが必要な際に自ら情報を取得できるようにしておく

チケットシステムに起票しておくのが良い→Backlogで自動で課題を立てるなど

## 2.6.4 通知プロセス
通知する先のメールアドレスをアプリケーションで管理しない
→退職時などアプリケーション側の修正が必要になるため

元々存在している従業員のテーブルでメールアドレスを管理し、その情報を通知に使う

## 2.6.5 エラー処理
エラーを出してユーザーにできるだけ多くの情報を提供する
タスクを再起動するかどうかはユーザーに判断してもらう


## 面白ワード
- Linux、お前のことだ！
- 結局これらのツール（メッセージやチャット）によって得られた結果は、貧弱なコミュニケーションをより速く行えるようになるというものだけでした
- 承認プロセスを作成すること自体が喜びであるような人は本当に異常な人だけです